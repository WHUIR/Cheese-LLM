<p align="center">
<img width="500px" alt="Project Cheese-LLM" src="https://github.com/WHUIR/Cheese-ChatBot/blob/96fd23596b6579da96260c3fbdf068ac29a451f1/Cheese.png">
</p>

## What's Cheese?
Cheese is an open-source LLM trained for the Chinese language by Data Intelligence (Dance) Laboratory, School of Cyber Science and Engineering, Wuhan University. 
On the basis of Chinese-Llama, it is built by further going through a series of pre-training, supervised fine-tuning and reinforcement learning from human feedback(RLHF) over different large-scale Chinese datasets that that are web-crawled and high-quality.
Some highlights include a more comprehensive Chinese vocabulary and more than 700K dialogs generated by ChatGPT used through SFT to enhance the capacity of answering diverse information needs. 
The Cheese-LLM is now available on GitHub for use in a wide spectrum of research tasks: question-answering, information search, personal assitant, to name a few.


## Why it's called Cheese?
We chose the name 'Cheese'(ËäùÂ£´) because its Chinese words sounds similarly to 'Knowledge'(Áü•ËØÜ) and is spelled similar to 'Chinese' in English. This reflects our commitment to developing LLMs that are more knowledgeable in Chinese language, as well as our emphasis on providing a helpful and informative AI assistant.

## Overview
Please be advised that all model weights and data provided here are intended for **research purposes ONLY**. Any commercial use of this information is **strictly prohibited**. We assume **no responsibility or liability** for any consequences resulting from the use of our weights, codes, or data.

<!-- 
Our objective in this repository is to construct a series of Chinese-LLM using LLaMA. 
The repository encompasses the following components:
- The [code]() for pre-training and supervised fine-tuning, utilizing DeepSpeed and Lora.
- The [code]() for reinforcement learning, which incorporates human feedback.
- The [code]() for deploying the model with FastChat.
- The [code]() for integrating the Lora weights into the Llama model.



## Usage

### Setup
1. Install dependencies

```bash
pip install -r requirements.txt
```
2. If `deepspeed` doesn't work, [install the lastest version](https://github.com/microsoft/DeepSpeed).
```bash
git clone https://github.com/microsoft/DeepSpeed
python setup.py install
```



### Training
The pre-training, finetuning, reinfor code is designed to run on an A100-40G GPU. 

1. Pre-training:
```bash
bash ./scripts/step1_pretraining.sh
```

2. SFT:
```bash
bash ./scripts/step1_pretraining.sh
```

3. Reward Model:
```bash
to update
```

4. RLHF:
```bash
to update 
```
-->
<!-- 

### Merge LoRA into LLaMA
Now you can easily merge the trained LoRA weights into a LLaMA model so you can use it with everything that supports standard Hugging Face API!

Here's an example for merging `Cheese-lora-7B` into Chinese-LLaMA-7B.
```bash
python ./scripts/merge_lora.py \
--base decapoda-research/llama-7b-hf  \
--target ./cheese-llama-7b \
--lora cheese-llm/cheese-lora
```  -->

<!-- ## Performance
To evaluate the performance of our model, we compared it with two other models: [Alpaca-7B](https://github.com/tloen/alpaca-lora) and [Chinese-Alpaca-Plus-7B](https://github.com/ymcui/Chinese-LLaMA-Alpaca). Utilizing the [evaluation setting](https://github.com/ymcui/Chinese-LLaMA-Alpaca/blob/main/examples/README.md), we conducted an assessment of ten tasks proposed by our method using 200 queries. It is important to note that response generation is stochastic and influenced by several factors, including decoding hyperparameters and random seeds. Consequently, the evaluations presented here are not entirely rigorous and should only be used as a reference. We encourage you to try our model firsthand.

| Task                           |                     Samples                     |  #   | Alpaca-7B | Chinese-Alpaca-Plus-7B | Cheese-Alpace-7B |
| ------------------------------ | :---------------------------------------------: | :--: | :-------: | :--------: | :------------: |
| **üíØ Overall** |                   -                    |  200   |     65.3     |      70.9      |     **üëçüèª75.3**     |
| Question Answering |            [QA.md](./examples/QA.md)            |   20   |      66       |       74       |      **üëçüèª80**      |
| Open QA |           [OQA.md](./OQA.md)           |   20   |   **üëçüèª79**    |       74       |      **üëçüèª78**      |
| Computation, Reasoning |     [REASONING.md](./examples/REASONING.md)     |   20   |      31       |    **üëçüèª50**    |         45         |
| Poetry, Literature, Philosophy |    [LITERATURE.md](./examples/LITERATURE.md)    |   20   |      68       |       73       |      **üëçüèª76**      |
| Music, Sports, Entertainment | [ENTERTAINMENT.md](./examples/ENTERTAINMENT.md) |   20   |      68       |       74       |      **üëçüèª79**      |
| Letters and Articles |    [GENERATION.md](./examples/GENERATION.md)    |   20   |      76       |    **üëçüèª81**    |      **üëçüèª81**      |
| Translation |   [TRANSLATION.md](./examples/TRANSLATION.md)   |   20   |      76       |       78       |      **üëçüèª82**      |
| Multi-turn Dialogue |      [DIALOGUE.md](./examples/DIALOGUE.md)      |   20   |   **üëçüèª83**    |       73       |      **üëçüèª84**      |
| Coding   |          [CODE.md](./examples/CODE.md)          |   20   |      57       |    **üëçüèª64**    |         59         |
| Ethics |        [ETHICS.md](./examples/ETHICS.md)        |   20   |      49      |       68       |      **üëçüèª89**      | -->



## Model Hub
You can download all the above models in ü§óModel Hub, and use [ü§ótransformers](https://github.com/huggingface/transformers) and [ü§óPEFT](https://github.com/huggingface/peft) to call heese weights. 

| Model              |             MODEL_NAME             |                             Link                             |
| ------------------ | :--------------------------------: | :----------------------------------------------------------: |
| Cheese-LLaMA-7B    | cheese-llama-7b       | [Model Hub Link]() |
| Cheese-RLHF-LLaMA-7B| cheese-rlhf-llama-7b       | to update |


## Contributors
Kui Liu, Shirui Hu, Yesheng Liu, Xuekong Xu, Zihao Li, Rui Zhu, Xinyu Zou
### Principle Investigator (PI)
Lixin Zou, Chenliang LI

## Acknowledgement
School of Cyber Science and Engineering, Wuhan University

Aixin Sun, Nanyang Technological University

Qi Zhang, Fudan University

One February night in Beijing: A wonderful dinner at ‰∏≤‰∫≠Â±ÖÈÖíÂ±ã (a Japanese Izakaya located at Tsinghua Tech. Park) with Kang Liu, Zhiyuan Liu, Xipeng Qiu, Jiajun Zhang, Binyang Li and Xianpei Han
